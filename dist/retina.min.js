function chooseCap(e){var t=parseInt(e,10);return t>environment?environment:t}function forceOriginalDimensions(e){return e.hasAttribute("data-no-resize")||(0===e.offsetWidth&&0===e.offsetHeight?(e.setAttribute("width",e.naturalWidth),e.setAttribute("height",e.naturalHeight)):(e.setAttribute("width",e.offsetWidth),e.setAttribute("height",e.offsetHeight))),e}function setSourceIfAvailable(e,t){var n=e.nodeName.toLowerCase(),a=document.createElement("img");a.addEventListener("load",function(){"img"===n?forceOriginalDimensions(e).setAttribute("src",t):e.style.backgroundImage="url("+t+")"}),a.setAttribute("src",t)}function dynamicSwapImage(e,t){var n=arguments.length<=2||void 0===arguments[2]?1:arguments[2],a=chooseCap(n);if(t&&a>1){var i=t.replace(srcReplace,"@"+a+"x$1");setSourceIfAvailable(e,i)}}function manualSwapImage(e,t,n){environment>1&&setSourceIfAvailable(e,n)}function getImages(){return"undefined"!=typeof document?Array.prototype.slice.call(document.querySelectorAll(selector)):[]}function cleanBgImg(e){return e.style.backgroundImage.replace(inlineReplace,"$2")}function retina(){getImages().forEach(function(e){var t="img"===e.nodeName.toLowerCase(),n=t?e.getAttribute("src"):cleanBgImg(e),a=e.getAttribute("data-rjs"),i=!isNaN(parseInt(a,10));i?dynamicSwapImage(e,n,a):manualSwapImage(e,n,a)})}"undefined"==typeof exports&&(exports={}),Object.defineProperty(exports,"__esModule",{value:!0});var hasWindow="undefined"!=typeof window,environment=hasWindow?window.devicePixelRatio||1:1,srcReplace=/(\.[A-z]{3,4}\/?(\?.*)?)$/,inlineReplace=/url\(('|")?([^\)'"]+)('|")?\)/i,selector="[data-rjs]";hasWindow&&(window.addEventListener("load",retina),window.retinajs=retina),exports["default"]=retina;